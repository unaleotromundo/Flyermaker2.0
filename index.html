<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Leandro Lizarazu">
  <meta name="description" content="Catálogo de productos de prueba con editor de flyers">
  <title>Tu Catálogo con Editor de Flyers</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="menu-catalogo">
  <a href="#" class="logo">Tu Catálogo</a>
  <div class="botones">
    <a href="https://wa.me/tunumerodecelular" class="btn-whatsapp" target="_blank">
      <img src="images/whatsapp.png" alt="WhatsApp">
    </a>
    <button id="abrirGaleriaBtn" class="btn-stickers">
      <img src="images/emoji.png" alt="Stickers">
    </button>
  </div>
</header>

<main>
  <section class="editor-flyer">
    <h2>Crea tu Flyer</h2>
    <canvas id="flyerCanvas" width="600" height="400"></canvas>
    <div class="herramientas">
      <button id="descargarFlyerBtn" class="boton">Descargar Flyer</button>
    </div>
  </section>

  <div id="galeriaStickers" class="galeria-overlay">
    <div class="galeria-contenido">
      <h3>Elige un Sticker:</h3>
      <div class="stickers-bar">
        </div>
    </div>
  </div>

  <section class="productos">
    <h2>Nuestros Productos</h2>
    <div class="producto">
      <img src="images/producto1.jpg" alt="Producto 1">
      <h3>Producto 1</h3>
      <p>Descripción breve del producto 1.</p>
      <span class="precio">$100</span>
      <button class="boton-agregar">Agregar</button>
    </div>
    <div class="producto">
      <img src="images/producto2.jpg" alt="Producto 2">
      <h3>Producto 2</h3>
      <p>Descripción breve del producto 2.</p>
      <span class="precio">$150</span>
      <button class="boton-agregar">Agregar</button>
    </div>
    <div class="producto">
      <img src="images/producto3.jpg" alt="Producto 3">
      <h3>Producto 3</h3>
      <p>Descripción breve del producto 3.</p>
      <span class="precio">$200</span>
      <button class="boton-agregar">Agregar</button>
    </div>
  </section>
</main>

<footer>
  <p>&copy; 2023 Tu Catálogo. Todos los derechos reservados.</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const canvas = document.getElementById('flyerCanvas');
  const ctx = canvas.getContext('2d');
  const galeriaStickers = document.getElementById('galeriaStickers');
  const abrirGaleriaBtn = document.getElementById('abrirGaleriaBtn');
  const descargarFlyerBtn = document.getElementById('descargarFlyerBtn');
  const stickersBar = document.querySelector('.stickers-bar');
  
  let selectedSticker = null;
  const stickers = {};
  const imagesPath = 'images/';

  // Lista de nombres de archivo de los stickers
  const stickerFiles = [
    'fb-icon.png', 'whatsapp-icon.png', 'ig-icon.png', 'x-icon.png', 'telegram-icon.png',
    'happy.png', 'sad.png', 'heart.png', 'flag-arg.png', 'flag-bra.png'
  ];

  // Precargar las imágenes de los stickers y crear los elementos en la galería
  stickerFiles.forEach(file => {
    const imageName = file.split('.')[0];
    const stickerDiv = document.createElement('div');
    stickerDiv.classList.add('sticker-option');
    stickerDiv.dataset.sticker = imageName;
    stickerDiv.style.backgroundImage = `url('${imagesPath}${file}')`;
    stickersBar.appendChild(stickerDiv);

    stickers[imageName] = new Image();
    stickers[imageName].src = `${imagesPath}${file}`;
  });

  // Mostrar la galería de stickers al hacer clic en el botón
  abrirGaleriaBtn.addEventListener('click', function() {
    galeriaStickers.style.display = 'flex';
  });

  // Ocultar la galería y seleccionar el sticker
  stickersBar.addEventListener('click', function(e) {
    const target = e.target;
    if (target.classList.contains('sticker-option')) {
      selectedSticker = target.dataset.sticker;
      galeriaStickers.style.display = 'none'; // Oculta la galería al seleccionar
      console.log(`Sticker seleccionado: ${selectedSticker}`);
    }
  });

  // Dibujar el sticker en el canvas al hacer clic
  canvas.addEventListener('click', function(e) {
    if (selectedSticker && stickers.hasOwnProperty(selectedSticker)) {
      const stickerImage = stickers[selectedSticker];
      if (stickerImage.complete) {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left - (stickerImage.width / 2);
        const y = e.clientY - rect.top - (stickerImage.height / 2);
        ctx.drawImage(stickerImage, x, y);
      } else {
        stickerImage.onload = function() {
          const rect = canvas.getBoundingClientRect();
          const x = e.clientX - rect.left - (stickerImage.width / 2);
          const y = e.clientY - rect.top - (stickerImage.height / 2);
          ctx.drawImage(stickerImage, x, y);
        };
      }
    }
  });

  // Descargar el flyer
  descargarFlyerBtn.addEventListener('click', function() {
    const dataURL = canvas.toDataURL('image/png');
    const a = document.createElement('a');
    a.href = dataURL;
    a.download = 'mi_flyer.png';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });
});
</script>

</body>
</html>